/*! For license information please see student_absence-d8fe37bee6a15eecbaa7.js.LICENSE.txt */
(()=>{"use strict";var e,t={"./assets/js/student_absence.js":(e,t,n)=>{var s,r=n("./node_modules/vue/dist/vue.common.prod.js"),a=n.n(r),o=n("./node_modules/vuex/dist/vuex.esm.js"),i=n("./node_modules/deepmerge/dist/cjs.js"),c=n.n(i);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function f(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}s=function(){function e(){l(this,e)}return f(e,[{key:"key",value:function(e){return Object.keys(this)[e]}},{key:"setItem",value:function(e,t){this[e]=t.toString()}},{key:"getItem",value:function(e){return this[e]}},{key:"removeItem",value:function(e){delete this[e]}},{key:"clear",value:function(){for(var e=0,t=Object.keys(this);e<t.length;e++)delete this[t[e]]}},{key:"length",get:function(){return Object.keys(this).length}}]),e}();var b=function(){function e(){l(this,e),this._queue=[],this._flushing=!1}return f(e,[{key:"enqueue",value:function(e){return this._queue.push(e),this._flushing?Promise.resolve():this.flushQueue()}},{key:"flushQueue",value:function(){var e=this;return this._flushing=!0,Promise.resolve(function t(){var n=e._queue.shift();if(n)return n.then(t);e._flushing=!1}())}}]),e}(),p={replaceArrays:{arrayMerge:function(e,t,n){return t}},concatArrays:{arrayMerge:function(e,t,n){return e.concat.apply(e,function(e){if(Array.isArray(e))return u(e)}(s=t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(s)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var s}}};function h(e,t,n){return c()(e,t,p[n])}var v=JSON;var m=n("./node_modules/axios/index.js"),g=n.n(m),_=n("./node_modules/moment/moment.js"),y=n.n(_),A=n("./assets/common/filters.js");y().locale("fr"),a().use(o.ZP);var S=new function e(t){var r=this;l(this,e),this._mutex=new b,this.subscriber=function(e){return function(t){return e.subscribe(t)}},void 0===t&&(t={}),this.key=null!=t.key?t.key:"vuex",this.subscribed=!1,this.supportCircular=t.supportCircular||!1,this.supportCircular&&(v=n("./node_modules/vuex-persist/node_modules/flatted/cjs/index.js")),this.mergeOption=t.mergeOption||"replaceArrays";var a=!0;try{window.localStorage.getItem("")}catch(e){a=!1}if(t.storage)this.storage=t.storage;else if(a)this.storage=window.localStorage;else{if(!s)throw new Error("Neither 'window' is defined, nor 'MockStorage' is available");this.storage=new s}this.reducer=null!=t.reducer?t.reducer:null==t.modules?function(e){return e}:function(e){return t.modules.reduce((function(t,n){return h(t,(s={},a=n,o=e[n],a in s?Object.defineProperty(s,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[a]=o,s),r.mergeOption);var s,a,o}),{})},this.filter=t.filter||function(e){return!0},this.strictMode=t.strictMode||!1,this.RESTORE_MUTATION=function(e,t){for(var n=h(e,t||{},this.mergeOption),s=0,r=Object.keys(n);s<r.length;s++){var a=r[s];this._vm.$set(e,a,n[a])}},this.asyncStorage=t.asyncStorage||!1,this.asyncStorage?(this.restoreState=null!=t.restoreState?t.restoreState:function(e,t){return t.getItem(e).then((function(e){return"string"==typeof e?r.supportCircular?v.parse(e||"{}"):JSON.parse(e||"{}"):e||{}}))},this.saveState=null!=t.saveState?t.saveState:function(e,t,n){return n.setItem(e,r.asyncStorage?h({},t||{},r.mergeOption):r.supportCircular?v.stringify(t):JSON.stringify(t))},this.plugin=function(e){e.restored=r.restoreState(r.key,r.storage).then((function(t){r.strictMode?e.commit("RESTORE_MUTATION",t):e.replaceState(h(e.state,t||{},r.mergeOption)),r.subscriber(e)((function(e,t){r.filter(e)&&r._mutex.enqueue(r.saveState(r.key,r.reducer(t),r.storage))})),r.subscribed=!0}))}):(this.restoreState=null!=t.restoreState?t.restoreState:function(e,t){var n=t.getItem(e);return"string"==typeof n?r.supportCircular?v.parse(n||"{}"):JSON.parse(n||"{}"):n||{}},this.saveState=null!=t.saveState?t.saveState:function(e,t,n){return n.setItem(e,r.supportCircular?v.stringify(t):JSON.stringify(t))},this.plugin=function(e){var t=r.restoreState(r.key,r.storage);r.strictMode?e.commit("RESTORE_MUTATION",t):e.replaceState(h(e.state,t||{},r.mergeOption)),r.subscriber(e)((function(e,t){r.filter(e)&&r.saveState(r.key,r.reducer(t),r.storage)})),r.subscribed=!0})}({storage:window.localStorage,reducer:function(e){return e.settings=settings,e}}),w={xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken"};const k=new o.ZP.Store({state:{settings,filters:[],savedAbsences:{},changes:[],notes:{},onLine:!0,lastUpdate:"",updating:!1,forceAllAccess:!1,periods:[]},getters:{change:function(e){return function(t){return e.changes.find((function(e){return e.matricule==t.matricule&&e.date_absence==t.date_absence&&e.period==t.period}))||null}},savedAbsence:function(e){return function(t){return e.savedAbsences.find((function(e){var n=e.student_id==t.matricule,s=e.date_absence==t.date_absence,r=e.period==t.period;return n&&s&&r}))||null}}},mutations:{setPeriods:function(e,t){e.periods=t},toggleForceAllAccess:function(e){e.forceAllAccess=!e.forceAllAccess,this.commit("updateStudentsClasses")},addNote:function(e,t){e.notes[t.classe]=t},addFilter:A.KJ,removeFilter:A.ku,removeChange:function(e,t){for(var n in e.changes)if(e.changes[n].matricule==t.matricule&&e.changes[n].date_absence==t.date_absence&&e.changes[n].period==t.period){e.changes.splice(n,1);break}},setChange:function(e,t){var n=null;for(var s in e.changes)if(e.changes[s].matricule==t.matricule&&e.changes[s].date_absence==t.date_absence&&e.changes[s].period==t.period){e.changes[s].index=s,n=e.changes[s];break}n?(e.changes[n.index].is_absent=t.is_absent,a().set(e.changes,n.index,e.changes[n.index])):e.changes.push(t)},setSavedAbsences:function(e,t){for(var n in t)"student"in t[n]&&delete t[n].student.savedAbsence.student.savedAbsence;e.savedAbsences=t},updateSavedAbsences:function(e,t){var n="/student_absence/api/student_absence/?page_size=5000&";return n+="forceAllAccess="+e.forceAllAccess+"&",n+="date_absence="+t,e.updating=!0,g().get(n,w).then((function(t){return e.savedAbsences=t.data.results,e.updating=!1,e.savedAbsences}))},updateStudentsClasses:function(e){var t=this;e.lastUpdate=y()().format("YYYY-MM-DD"),this.commit("updatingStatus",!0);var n=e.settings.filter_students_for_educ,s={query:"everybody",teachings:e.settings.teachings,people:"student",active:!0,check_access:"none"!=n&&!e.forceAllAccess,educ_by_years:"year"==n&&!e.forceAllAccess};g().post("/student_absence/api/students_classes/",s,w).then((function(){t.commit("updatingStatus",!1),setTimeout((function(){document.location.reload()}),500)})),g().get("/student_absence/api/classenote/",w).then((function(e){for(var n in e.data.results)t.commit("addNote",e.data.results[n])}))},updatingStatus:function(e,t){e.updating=t},changeOnLineStatus:function(e,t){e.onLine=t}},plugins:[S.plugin]});var C=n("./node_modules/vue-router/dist/vue-router.esm.js"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-container",[n("b-row",[n("h1",[e._v("Absences Élèves")])]),e._v(" "),n("b-row",[n("b-nav",{attrs:{tabs:""}},[n("b-nav-item",{attrs:{to:"overview"}},[e._v("\n                    Vue d'ensemble\n                ")]),e._v(" "),n("b-nav-item",{attrs:{to:"add_absence"}},[n("icon",{staticClass:"align-middle",attrs:{name:"plus",scale:"1",color:"green"}}),e._v("\n                    Ajouter absences\n                ")],1),e._v(" "),n("b-nav-item",{attrs:{to:"list"}},[e._v("\n                    Liste d'absences\n                ")]),e._v(" "),n("b-nav-item",{attrs:{to:"notes"}},[e._v("\n                    Notes\n                ")]),e._v(" "),n("b-nav-item-dropdown",{attrs:{right:""}},[n("b-dropdown-item",{on:{click:function(t){return e.$store.commit("updateStudentsClasses")}}},[e._v("\n                        Mettre à jour des étudiants\n                    ")]),e._v(" "),n("b-dropdown-item",{on:{click:function(t){return e.$store.commit("toggleForceAllAccess")}}},[e._v("\n                        "+e._s(e.$store.state.forceAllAccess?"Activer":"Désactiver")+" la restriction par classe\n                    ")])],1)],1)],1),e._v(" "),n("router-view")],1)],1)};O._withStripped=!0;var x=n("./node_modules/bootstrap-vue/esm/index.js"),j=n("./node_modules/bootstrap-vue/esm/icons/plugin.js"),I=(n("./node_modules/bootstrap-vue/dist/bootstrap-vue.css"),n("./node_modules/vue-awesome/icons/index.js"),n("./node_modules/vue-awesome/components/Icon.vue"));a().use(x.XG7),a().use(j.X),y().locale("fr"),a().component("icon",I.Z);const $={data:function(){return{}},mounted:function(){var e=this;setTimeout((function(){if(e.$store.state.onLine){var t="";""===e.$store.state.lastUpdate?t="Afin de pouvoir prendre les présences, il est nécessaire de copier la liste des étudiants et des classes dans le navigateur. Ceci permet à HappySchool de fonctionner sans connexion.":y()(e.$store.state.lastUpdate).add(1,"months").isBefore(y()())&&(t="Il semblerait que la liste des étudiants et des classes ne soit plus récente. Il est conseillé de mettre à jour celle-ci."),""!==t&&e.$bvModal.msgBoxConfirm(t,{title:"Mise à jour des étudiants et des classes",headerBgVariant:"info",headerTextVariant:"light",okTitle:"Mettre à jour",cancelTitle:"Annuler",hideHeaderClose:!1,centered:!0}).then((function(t){t&&(e.$router.push("add_absence"),e.$store.commit("updateStudentsClasses"))})).catch((function(e){console.log(e)}))}}),4e3)}};var P=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),E=(0,P.Z)($,O,[],!1,null,null,null);E.options.__file="assets/student_absence/student_absence.vue";const N=E.exports;var M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-card-group",{staticClass:"mt-2"},[n("b-card",{attrs:{title:"Dernières absences"}},[n("b-table",{attrs:{striped:"",hover:"",items:e.lastAbsences,fields:e.fields},scopedSlots:e._u([{key:"cell(student)",fn:function(t){return[n("a",{attrs:{href:"#/list"},on:{click:function(n){return e.filterStudent(t.item.student_id)}}},[e._v(e._s(t.value))])]}},{key:"cell(date_absence)",fn:function(t){return[e._v("\n                    "+e._s(t.value)+"\n                ")]}},{key:"cell(is_absent)",fn:function(t){return[e._v("\n                    "+e._s(t.value)+"\n                ")]}}])}),e._v(" "),n("b-overlay",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}]},[n("b-btn",{on:{click:e.getMoreAbsences}},[n("b-icon",{attrs:{icon:"chevron-double-down"}}),e._v("\n                    Afficher plus\n                ")],1)],1)],1)],1)],1)};M._withStripped=!0;var D=n("./assets/common/utilities.js");y().locale("fr");const T={data:function(){var e=this;return{lastAbsences:[],fields:[{key:"student",label:"Élèves",formatter:function(t){return e.displayStudent(t)}},{key:"date_absence",label:"Date",formatter:function(e){return y()(e).calendar().split(" à ")[0]}},{key:"is_absent",label:"Absence",formatter:function(t,n,s){var r=e.$store.state.periods.find((function(e){return e.id==s.period})).name;return t?r:""}}],absenceCount:[],absenceCountFields:{student:{label:"Élèves"},half_day_diff:{label:"Non just."},half_day_just:{label:"Just."},half_day_miss:{label:"Total"}},absenceNextPage:null,loading:!1}},methods:{displayStudent:D.v,filterStudent:function(e){this.$store.commit("addFilter",{tag:e,filterType:"student__matricule",value:e})},getMoreAbsences:function(){var e=this;this.absenceNextPage&&(this.loading=!0,g().get(this.absenceNextPage).then((function(t){e.lastAbsences=e.lastAbsences.concat(t.data.results),e.absenceNextPage=e.cleanUrlStr(t.data.next),e.loading=!1})).catch((function(){e.loading=!1})))},cleanUrlStr:function(e){return e.substr(e.indexOf("/",8))}},mounted:function(){var e=this,t="/student_absence/api/student_absence/?ordering=-datetime_creation&page_size=15&is_absent=true";this.$store.state.forceAllAccess&&(t+="&forceAllAccess=1"),g().get(t).then((function(t){e.lastAbsences=t.data.results,e.absenceNextPage=e.cleanUrlStr(t.data.next)}))}};var L=(0,P.Z)(T,M,[],!1,null,null,null);L.options.__file="assets/student_absence/overview.vue";const R=L.exports;var F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:"Date de l'absence :"}},[n("b-form-input",{attrs:{type:"date"},on:{change:e.loadAbsences},model:{value:e.date_absence,callback:function(t){e.date_absence=t},expression:"date_absence"}})],1)],1),e._v(" "),n("b-col",{staticClass:"text-right"},[n("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.tovalidate",modifiers:{tovalidate:!0}}],staticClass:"m-1",attrs:{disabled:0==e.$store.state.changes.length}},[n("b-icon",{attrs:{icon:"card-list"}}),e._v("\n                Absences non validées\n            ")],1),e._v(" "),n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.moreactions",modifiers:{moreactions:!0}}],staticClass:"mr-1"},[n("b-icon",{attrs:{icon:"caret-right"}}),e._v("\n                Plus d'actions\n            ")],1),e._v(" "),e.onLine?n("p",[n("b-icon",{attrs:{icon:"wifi",color:"green"}}),e._v("Connecté\n                "),n("b-btn",{staticClass:"m-1",attrs:{variant:"outline-primary",disabled:e.$store.state.updating},on:{click:function(t){return e.$store.commit("updateStudentsClasses")}}},[n("b-icon",{attrs:{icon:"download",animation:e.$store.state.updating?"fade":null}}),e._v("\n                    Mettre à jour\n                    "),n("b-icon",{attrs:{icon:"people-fill",animation:e.$store.state.updating?"fade":null}})],1)],1):n("p",[n("b-icon",{attrs:{icon:"wifi-off",color:"red"}}),e._v("Déconnecté\n            ")],1)],1)],1),e._v(" "),n("b-row",[n("b-col",[n("b-overlay",{attrs:{show:e.$store.state.updating,rounded:"sm"}},[e.date_absence.length>0?n("b-form-group",{attrs:{label:"Recherche :"}},[n("multiselect",{attrs:{id:"input-name","internal-search":!1,options:e.searchOptions,loading:e.searchLoading,placeholder:"Rechercher un étudiant, une classe","select-label":"","selected-label":"Sélectionné","deselect-label":"",label:"display","track-by":"id",disabled:e.$store.state.updating},on:{"search-change":e.getSearchOptions,select:e.selected},model:{value:e.currentSearch,callback:function(t){e.currentSearch=t},expression:"currentSearch"}},[n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Aucune personne trouvée.")]),e._v(" "),n("span",{attrs:{slot:"noOptions"},slot:"noOptions"})])],1):e._e()],1)],1)],1),e._v(" "),n("b-row",[n("b-col",[e.classe?n("b-card",[n("p",[e._v("Nombre d'étudiants : "+e._s(e.students.length)+".")]),e._v(" "),e.note.length>0?n("div",{domProps:{innerHTML:e._s(e.note)}}):e._e()]):e._e()],1)],1),e._v(" "),n("b-row",[n("b-col",[n("b-list-group",e._l(e.students,(function(t){return n("add-absence-entry",{key:t.matricule,attrs:{student:t,"date-absence":e.date_absence,"period-ids":e.currentPeriods}})})),1)],1)],1),e._v(" "),n("b-modal",{attrs:{size:"lg",id:"tovalidate",title:"Changements non validées","cancel-title":"Retour","ok-disabled":e.disableValidation},on:{ok:e.sendChanges}},[n("b-tabs",{model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[n("b-tab",{attrs:{title:"Absences du "+e.date_absence}},[e._l(e.getAbsences(!0,"classe"),(function(t,s){return n("div",{key:t,staticClass:"border-bottom pb-1 mb-1"},[n("strong",[e._v(e._s(t.toUpperCase()))]),e._v("\n                    (absent(s) :\n                    "),n("b-badge",{attrs:{variant:"primary"}},[e._v("\n                        "+e._s(e.getAbsences(!0,"student",t,!0).length)+"\n                    ")]),e._v("\n                    )\n                    "),n("b-form-group",{staticClass:"mt-2"},e._l(e.getAbsences(!0,"student",t,!0),(function(t){return n("b-form-checkbox",{key:t.matricule+t.period,attrs:{value:t},model:{value:e.selectedChanges,callback:function(t){e.selectedChanges=t},expression:"selectedChanges"}},[e._v("\n                            "+e._s(t.student.display)+" ("+e._s(e.getPeriod(t.period))+")\n                        ")])})),1),e._v(" "),n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"present-"+t,expression:"'present-' + cl"}],attrs:{href:"#",variant:"info"}},[e._v("\n                        Élèves présents\n                        "),n("b-badge",{attrs:{variant:"light"}},[e._v("\n                            "+e._s(e.getAbsences(!0,"student",t,!1).length)+"\n                        ")])],1),e._v(" "),n("b-collapse",{attrs:{id:"present-"+s}},[n("b-form-group",{staticClass:"mt-2"},e._l(e.getAbsences(!0,"student",t,!1),(function(t){return n("b-form-checkbox",{key:t.matricule+t.period,attrs:{value:t},model:{value:e.selectedChanges,callback:function(t){e.selectedChanges=t},expression:"selectedChanges"}},[e._v("\n                                "+e._s(t.student.display)+" ("+e._s(e.getPeriod(t.period))+")\n                            ")])})),1)],1)],1)})),e._v(" "),e.getAbsences(!0,"student").length>0?n("p",{staticClass:"text-muted"},[n("small",[e._v("\n                        Pour supprimer des changements, sélectionnez les changements pour faire\n                        apparaître le boutton de suppression.\n                    ")])]):e._e(),e._v(" "),0!=e.selectedChanges.length?n("b-btn",{staticClass:"mt-1",attrs:{variant:"danger"},on:{click:function(t){return e.removeChanges()}}},[e._v("\n                    Supprimer les élements sélectionnés\n                ")]):e._e()],2),e._v(" "),n("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n                    Autres absences non validées\n                    "),n("b-badge",{attrs:{variant:"primary"}},[e._v("\n                        "+e._s(e.getAbsences(!1,"student").length)+"\n                    ")])]},proxy:!0}])},[e._v(" "),e._l(e.getAbsences(!1,"classe"),(function(t,s){return n("div",{key:t,staticClass:"border-bottom"},[n("strong",[e._v(e._s(t.toUpperCase()))]),e._v("\n                    (absent(s) :\n                    "),n("b-badge",{attrs:{variant:"primary"}},[e._v("\n                        "+e._s(e.getAbsences(!1,"student",t,!0).length)+"\n                    ")]),e._v("\n                    )\n                    "),n("b-form-group",{staticClass:"mt-2"},e._l(e.getAbsences(!1,"student",t,!0),(function(t){return n("b-form-checkbox",{key:t.matricule+t.period,attrs:{value:t},model:{value:e.selectedOldChanges,callback:function(t){e.selectedOldChanges=t},expression:"selectedOldChanges"}},[e._v("\n                            "+e._s(t.student.display)+"\n                            ("),n("strong",[e._v(e._s(t.date_absence))]),e._v(" - "+e._s(e.getPeriod(t.period))+")\n                        ")])})),1),e._v(" "),n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"present-"+s,expression:"'present-' + clIdx"}],attrs:{href:"#",variant:"info"}},[e._v("\n                        Élèves présents\n                        "),n("b-badge",{attrs:{variant:"light"}},[e._v("\n                            "+e._s(e.getAbsences(!1,"student",t,!1).length)+"\n                        ")])],1),e._v(" "),n("b-collapse",{attrs:{id:"present-"+s}},[n("b-form-group",{staticClass:"mt-2"},e._l(e.getAbsences(!1,"student",t,!1),(function(t){return n("b-form-checkbox",{key:t.matricule+t.period,attrs:{value:t},model:{value:e.selectedOldChanges,callback:function(t){e.selectedOldChanges=t},expression:"selectedOldChanges"}},[e._v("\n                                "+e._s(t.student.display)+"\n                                ("),n("strong",[e._v(e._s(t.date_absence))]),e._v(" - "+e._s(e.getPeriod(t.period))+")\n                            ")])})),1)],1)],1)})),e._v(" "),e.getAbsences(!1,"student").length>0?n("p",{staticClass:"text-muted"},[n("small",[e._v("\n                        Pour supprimer des changements, sélectionnez les changements pour faire\n                        apparaître le boutton de suppression.\n                    ")])]):e._e(),e._v(" "),0!=e.selectedOldChanges.length?n("b-btn",{staticClass:"mt-1",attrs:{variant:"danger"},on:{click:function(t){return e.removeChanges("old")}}},[e._v("\n                    Supprimer les élements sélectionnés\n                ")]):e._e()],2)],1),e._v(" "),n("template",{slot:"modal-ok"},[e.sending?n("icon",{staticClass:"align-baseline",attrs:{name:"spinner",color:"white",spin:""}}):e._e(),e._v("\n            "+e._s(e.validateChange)+"\n        ")],1)],2),e._v(" "),n("b-sidebar",{attrs:{id:"moreactions",title:"Actions",right:"",shadow:""}},[n("div",{staticClass:"px-3 py-2 text-right"},[n("b-form-group",{attrs:{label:"Choisir une période","label-class":"font-weight-bold"}},e._l(e.$store.state.periods,(function(t){return n("b-form-checkbox",{key:t.id,attrs:{value:t.id},model:{value:e.currentPeriods,callback:function(t){e.currentPeriods=t},expression:"currentPeriods"}},[e._v("\n                    "+e._s(t.name)+"\n                    ("+e._s(t.start.substr(0,5))+"-"+e._s(t.end.substr(0,5))+")\n                ")])})),1),e._v(" "),n("b-form-group",{attrs:{label:"Classe","label-class":"font-weight-bold"}},[e.classe?n("b-btn",{on:{click:function(t){return e.addAllStudents(e.currentPeriods)}}},[e._v("\n                    Ajouter le reste de la classe ("+e._s(e.currentSearch.display)+")\n                ")]):n("p",[n("em",[e._v("Aucune classe sélectionnée")])])],1)],1)])],1)};F._withStripped=!0;var B,q,Z=n("./node_modules/vue-multiselect/dist/vue-multiselect.min.js"),U=n.n(Z);n("./node_modules/vue-multiselect/dist/vue-multiselect.min.css");var V=new WeakMap,W=new WeakMap,J=new WeakMap,H=new WeakMap,Y=new WeakMap,z={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return W.get(e);if("objectStoreNames"===t)return e.objectStoreNames||J.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function X(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(q||(q=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t.apply(Q(this),n),K(V.get(this))}:function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return K(t.apply(Q(this),n))}:function(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];var a=t.call.apply(t,[Q(this),e].concat(s));return J.set(a,e.sort?e.sort():[e]),K(a)}:(e instanceof IDBTransaction&&function(e){if(!W.has(e)){var t=new Promise((function(t,n){var s=function(){e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=function(){t(),s()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)}));W.set(e,t)}}(e),n=e,(B||(B=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return n instanceof e}))?new Proxy(e,z):e);var t,n}function K(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var s=function(){t.removeEventListener("success",r),t.removeEventListener("error",a)},r=function(){e(K(t.result)),s()},a=function(){n(t.error),s()};t.addEventListener("success",r),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&V.set(e,t)})).catch((function(){})),Y.set(n,t),n;var t,n;if(H.has(e))return H.get(e);var s=X(e);return s!==e&&(H.set(e,s),Y.set(s,e)),s}var Q=function(e){return Y.get(e)};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t,n,s,r,a,o){try{var i=e[a](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(s,r)}var se,re=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],oe=new Map;function ie(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(oe.get(t))return oe.get(t);var n=t.replace(/FromIndex$/,""),s=t!==n,r=ae.includes(n);if(n in(s?IDBIndex:IDBObjectStore).prototype&&(r||re.includes(n))){var a=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var a,o,i,c,u,l,d,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,r?"readwrite":"readonly"),i=o.store,c=f.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=f[l];return s&&(i=i.index(u.shift())),e.next=6,(a=i)[n].apply(a,u);case 6:if(d=e.sent,!r){e.next=10;break}return e.next=10,o.done;case 10:return e.abrupt("return",d);case 11:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(s,r){var a=e.apply(t,n);function o(e){ne(a,s,r,o,i,"next",e)}function i(e){ne(a,s,r,o,i,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}();return oe.set(t,a),a}}}z=ee(ee({},se=z),{},{get:function(e,t,n){return ie(e,t)||se.get(e,t,n)},has:function(e,t){return!!ie(e,t)||se.has(e,t)}});var ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-list-group-item",[n("b-row",[n("b-col",{attrs:{cols:"3"}},[e._v("\n            "+e._s(e.displayStudent(e.student))+"\n        ")]),e._v(" "),n("b-col",[n("b-row",e._l(e.periodIds,(function(t,s){return n("b-col",{key:t,staticClass:"text-center"},[e.period(t)?n("b-form-checkbox",{attrs:{name:"is-absent",switch:""},on:{change:function(t){return e.changeAbsence(s)}},model:{value:e.isAbsent[s],callback:function(t){e.$set(e.isAbsent,s,t)},expression:"isAbsent[idx]"}},[n("span",{class:e.isSaved()?"font-italic":""},[e._v("\n                            "+e._s(e.period(t).name)+"\n                        ")])]):e._e()],1)})),1)],1)],1)],1)};ce._withStripped=!0;const ue={props:{dateAbsence:{type:String,default:""},student:{type:Object,default:function(){}},periodIds:{type:Array,default:function(){return[]}}},data:function(){return{isAbsent:[]}},watch:{periodIds:function(){this.initAbsence()}},methods:{displayStudent:D.v,baseAbsence:function(e){var t={matricule:this.student.matricule,date_absence:this.dateAbsence,student:this.student,period:this.periodIds[e]};return this.$store.getters.change(t)||this.$store.getters.savedAbsence(t)},checkData:function(e){return this.baseAbsence(e)?this.baseAbsence(e).is_absent:void 0},period:function(e){return this.$store.state.periods.find((function(t){return t.id===e}))},isSaved:function(){return this.baseAbsence&&"id"in this.baseAbsence},changeAbsence:function(e){var t=!this.checkData(e),n={matricule:this.student.matricule,date_absence:this.dateAbsence,student:this.student,period:this.periodIds[e],is_absent:t};this.baseAbsence(e)&&t==this.baseAbsence(e).is_absent?this.$store.commit("removeChange",n):(this.baseAbsence(e)&&"id"in this.baseAbsence(e)&&(n.id=this.baseAbsence(e).id),this.$store.commit("setChange",n))},initAbsence:function(){var e=this;this.isAbsent=this.periodIds.map((function(t,n){return e.baseAbsence(n)?e.baseAbsence(n).is_absent:void 0}))}},mounted:function(){this.initAbsence()}};var le=(0,P.Z)(ue,ce,[],!1,null,null,null);le.options.__file="assets/student_absence/add_absence_entry.vue";const de=le.exports;function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}y().locale("fr");var be={xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken"};const pe={data:function(){return{date_absence:"",searchOptions:[],searchLoading:!1,currentSearch:null,students:[],savedAbsences:[],searchId:-1,selectedOldChanges:[],selectedChanges:[],tabIndex:0,sending:!1,classe:null,currentPeriods:[],note:""}},computed:{onLine:function(){return this.$store.state.onLine},validateChange:function(){return 0==this.tabIndex?"Valider les changements du "+this.date_absence:"Valider les autres changements"},disableValidation:function(){return 0==this.getAbsences(0==this.tabIndex,"students").length}},methods:{getPeriod:function(e){return this.$store.state.periods.find((function(t){return t.id===e})).name},addAllStudents:function(e){var t=this,n=function(n){var s=t.$store.state.savedAbsences.filter((function(s){return s.period==e[n]&&s.date_absence==t.date_absence})).map((function(e){return e.student_id})),r=t.$store.state.changes.filter((function(s){return s.period==e[n]&&s.date_absence==t.date_absence})).map((function(e){return e.matricule}));t.students.filter((function(e){return!r.includes(e.matricule)&&!s.includes(e.matricule)})).forEach((function(s){var r={date_absence:t.date_absence,matricule:s.matricule,student:s,period:e[n],is_absent:!1};t.$store.commit("setChange",r)}))};for(var s in e)n(s)},cleanStudents:function(){this.students=[],this.classe=null,this.currentSearch=null},getAbsences:function(e,t,n,s){var r,a=this,o=this.$store.state.changes.filter((function(t){return e?t.date_absence==a.date_absence:t.date_absence!=a.date_absence}));return"classe"==t?(r=new Set(o.map((function(e){return e.student.classe.year+e.student.classe.letter}))),function(e){if(Array.isArray(e))return fe(e)}(r)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort():(n&&(o=o.filter((function(e){return e.student.classe.year+e.student.classe.letter==n}))),null!=s&&(o=o.filter((function(e){return e.is_absent==s}))),o.sort((function(e,t){return e.student.classe.year<t.student.classe.year?-1:e.student.classe.year==t.student.classe.year?e.student.classe.letter<t.student.classe.letter?-1:e.student.classe.letter==t.student.classe.letter?0:1:1})))},removeChanges:function(e){var t="old"==e?this.selectedOldChanges:this.selectedChanges;for(var n in t)this.$store.commit("removeChange",t[n]);"old"==e?this.selectedOldChanges=[]:(this.selectedChanges=[],this.cleanStudents())},selected:function(e){var t=this;"classe"==e.type?(this.classe=e.id,this.students=e.students.sort((function(e,t){return e.display.localeCompare(t.display)})),this.classe in this.$store.state.notes&&(this.note=this.$store.state.notes[this.classe].note)):(this.classe=null,g().get("/annuaire/api/student/"+e.matricule+"/").then((function(){t.students=[e]})).catch((function(){alert("Impossible de trouver l'élève sur le serveur.")})))},getSearchOptions:function(e){var t=this;if(0!=e.length){var n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=n.blocked,r=n.upgrade,a=n.blocking,o=n.terminated,i=indexedDB.open(e,t),c=K(i);return r&&i.addEventListener("upgradeneeded",(function(e){r(K(i.result),e.oldVersion,e.newVersion,K(i.transaction))})),s&&i.addEventListener("blocked",(function(){return s()})),c.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),c}("annuaire",1);isNaN(e[0])?n.then((function(n){n.getAll("students").then((function(n){var s=n.filter((function(t){return!!t.last_name.toLowerCase().startsWith(e.toLowerCase())||!!t.first_name.toLowerCase().startsWith(e.toLowerCase())||void 0})).slice(0,50);t.searchOptions=s.map((function(e){return e.type="student",e.id=e.matricule,e}))}))})):n.then((function(n){n.getAllKeys("classes").then((function(s){var r=s.filter((function(t){if(t.toLowerCase().startsWith(e.toLowerCase()))return!0})),a=[],o=function(e){var t=[];n.get("classes",r[e]).then((function(s){for(var o in s.students)n.get("students",s.students[o]).then((function(e){t.push(e)}));a.push({type:"classe",students:t,display:r[e],id:s.id})}))};for(var i in r)o(i);t.searchOptions=a.sort((function(e,t){return e.display.localeCompare(t.display)}))}))}))}},sendChanges:function(e){var t=this;e.preventDefault(),this.sending=!0;var n=this,s="/student_absence/api/student_absence/",r=0==this.tabIndex?this.getAbsences(!0,"student"):this.getAbsences(!1,"student"),a=r.filter((function(e){return"id"in e})),o=r.filter((function(e){return!("id"in e)})).map((function(e){return e.student_id=e.matricule,e})),i=a.map((function(e){return g().put("".concat(s).concat(e.id,"/?forceAllAccess=true"),e,be)}));o.length>0&&i.push(g().post("".concat(s,"?forceAllAccess=true"),o,be)),Promise.all(i).then((function(e){for(var s in e)"put"==e[s].config.method?(e[s].data.matricule=e[s].data.student_id,t.$store.commit("removeChange",e[s].data)):"post"==e[s].config.method&&e[s].data.forEach((function(e){e.matricule=e.student_id,t.$store.commit("removeChange",e)}));n.$bvModal.hide("tovalidate"),n.loadAbsences(n.date_absence),n.sending=!1})).catch((function(e){n.sending=!1,n.loadAbsences(n.date_absence),alert(e)}))},loadAbsences:function(e){this.cleanStudents(),this.date_absence=e,0!=this.date_absence.length&&this.$store.commit("updateSavedAbsences",e)}},mounted:function(){var e=y()();this.$store.state.periods.length<3?this.currentPeriods=this.$store.state.periods.map((function(e){return e.id})):this.currentPeriods=[this.$store.state.periods[0].id],this.loadAbsences(e.format("YYYY-MM-DD"))},components:{Multiselect:U(),AddAbsenceEntry:de}};var he=(0,P.Z)(pe,F,[],!1,null,null,null);he.options.__file="assets/student_absence/add_absence.vue";const ve=he.exports;var me=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("b-row",[t("b-col",[t("note-entry")],1)],1)],1)};me._withStripped=!0;var ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-card",[n("multiselect",{attrs:{"internal-search":!1,options:e.classeOptions,loading:e.classeLoading,placeholder:"Rechercher une classe…","select-label":"","selected-label":"Sélectionné","deselect-label":"",label:"display","track-by":"id"},on:{"search-change":e.getClasseOptions,select:e.getNote},model:{value:e.classe,callback:function(t){e.classe=t},expression:"classe"}},[n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Aucune personne trouvée.")]),e._v(" "),n("span",{attrs:{slot:"noOptions"},slot:"noOptions"}),e._v("\n            >\n        ")]),e._v(" "),n("b-form-group",[n("quill-editor",{attrs:{options:e.editorOptions},model:{value:e.currentNote,callback:function(t){e.currentNote=t},expression:"currentNote"}})],1),e._v(" "),n("b-btn",{attrs:{disabled:e.disabledSubmit},on:{click:function(t){return e.sendData()}}},[e._v("\n            Envoyer\n        ")])],1)],1)};ge._withStripped=!0;var _e=n("./node_modules/vue-quill-editor/dist/vue-quill-editor.js");n("./node_modules/quill/dist/quill.core.css"),n("./node_modules/quill/dist/quill.snow.css");const ye={data:function(){return{classe:null,classeOptions:[],classeLoading:!1,searchId:0,noteId:-1,currentNote:"",datetime_update:null,sending:!1,editorOptions:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],["clean"]]},placeholder:""}}},computed:{disabledSubmit:function(){return null==this.classe||this.sending}},methods:{getNote:function(e){var t=this;g().get("/student_absence/api/classenote/?classe="+e.id,{xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken"}).then((function(e){e.data.results.length>0?(t.noteId=e.data.results[0].id,t.currentNote=e.data.results[0].note,t.datetime_update=e.data.results[0].datetime_update):(t.noteId=-1,t.currentNote="",t.datetime_update=null)})).catch((function(e){alert(e)}))},getClasseOptions:function(e){var t=this;this.searchId+=1;var n=this.searchId,s={query:e,teachings:this.$store.state.settings.teachings,check_access:!1};g().post("/annuaire/api/classes/",s,{xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken"}).then((function(e){t.searchId===n&&(t.classeOptions=e.data)}))},sendData:function(){var e=this;this.sending=!0;var t=this.noteId<0,n=t?g().post:g().put,s="/student_absence/api/classenote/";t||(s+=this.noteId+"/");var r={note:this.currentNote,classe:this.classe.id};n(s,r,{xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken"}).then((function(t){e.noteId=t.data.id,e.$store.commit("addNote",r),e.sending=!1,e.$bvToast.toast("La note concernant la classe ".concat(e.classe.display," a été enregistrée."),{variant:"success",noCloseButton:!0})})).catch((function(t){alert(t),e.sending=!1}))}},components:{Multiselect:U(),quillEditor:_e.quillEditor}};var Ae=(0,P.Z)(ye,ge,[],!1,null,null,null);Ae.options.__file="assets/student_absence/note_entry.vue";const Se={data:function(){return{}},components:{NoteEntry:Ae.exports}};var we=(0,P.Z)(Se,me,[],!1,null,null,null);we.options.__file="assets/student_absence/notes.vue";const ke=we.exports;var Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-row",[n("b-col",[n("filters",{ref:"filters",attrs:{app:"student_absence",model:"student_absence","show-search":e.showFilters},on:{update:e.applyFilter,toggleSearch:function(t){e.showFilters=!e.showFilters}}})],1)],1),e._v(" "),n("b-row",{attrs:{"align-h":"between"}},[n("b-col",{staticClass:"mt-1",attrs:{cols:"12",md:"3"}},[n("b-pagination",{attrs:{"total-rows":e.entriesCount,"per-page":20},on:{change:e.changePage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),e._v(" "),n("b-col",{attrs:{cols:"12",md:"9",lg:"7"}},[n("b-row",{attrs:{"align-h":"end"}},[e.proecoActivated?n("b-col",{attrs:{cols:"12",md:"5"}},[n("b-btn",{staticClass:"w-100 mt-1",attrs:{href:e.exportSelection,target:"_blank",variant:"outline-secondary"}},[n("b-icon",{attrs:{icon:"file-earmark"}}),e._v("\n                        Export ProEco\n                    ")],1)],1):e._e()],1)],1)],1),e._v(" "),n("b-row",{staticClass:"mt-1"},[n("b-col",e._l(e.absences,(function(e){return n("absence-entry",{key:e.id,attrs:{absence:e}})})),1)],1),e._v(" "),e.entriesCount>10?n("b-row",[n("b-col",[n("b-pagination",{staticClass:"mt-2",attrs:{"total-rows":e.entriesCount,"per-page":20},on:{change:e.changePage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)],1):e._e()],1)};Ce._withStripped=!0;var Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-card",[n("strong",[e._v(e._s(e.absence.date_absence))]),e._v(":\n        "),n("a",{attrs:{href:"/annuaire/#/person/student/"+e.absence.student.matricule+"/"}},[e._v("\n            "+e._s(e.absence.student.display)+"\n        ")]),e._v("\n        "+e._s(e.display_absence)+"\n    ")])],1)};Oe._withStripped=!0,a().component("icon",I.Z);const xe={props:{absence:{type:Object,default:function(){}}},data:function(){return{}},computed:{display_absence:function(){var e=this;return(this.absence.is_absent?"Absent":"Présent")+" ("+this.$store.state.periods.find((function(t){return t.id==e.absence.period})).name+")"}}};var je=(0,P.Z)(xe,Oe,[],!1,null,null,null);je.options.__file="assets/student_absence/absence_entry.vue";const Ie={data:function(){return{absences:[],active:!1,showFilters:!0,filter:"",currentPage:1,entriesCount:0,proecoActivated:proeco}},computed:{exportSelection:function(){return"/student_absence/api/export_selection/?page_size=1000"+this.filter}},watch:{active:function(e){e?this.$store.commit("addFilter",{filterType:"activate_last_absence",tag:"Activer",value:"true_activate_last_absence"}):this.$store.commit("removeFilter","activate_last_absence"),this.applyFilter()}},methods:{changePage:function(e){this.currentPage=e,this.loadEntries(),scroll(0,0)},applyFilter:function(){this.filter=(0,A.Zj)(this.$store.state.filters),this.loadEntries()},loadEntries:function(){var e=this,t="/student_absence/api/student_absence/?ordering=-date_absence"+this.filter+"&page="+this.currentPage;this.$store.state.forceAllAccess&&(t+="&forceAllAccess=1"),g().get(t).then((function(t){e.entriesCount=t.data.count,e.absences=t.data.results}))}},mounted:function(){this.applyFilter()},components:{AbsenceEntry:je.exports,Filters:n("./assets/common/filters.vue").Z}};var $e=(0,P.Z)(Ie,Ce,[],!1,null,null,null);$e.options.__file="assets/student_absence/list.vue";const Pe=$e.exports;a().use(C.Z);const Ee=new C.Z({routes:[{path:"",component:N,children:[{path:"",component:R},{path:"overview",component:R},{path:"add_absence",component:ve},{path:"notes",component:ke},{path:"list",component:Pe}]}]});var Ne=n("./assets/common/menu.vue");y().locale("fr"),"serviceWorker"in navigator&&navigator.serviceWorker.register("/static/bundles/student_absence_sw.js?hash="+hash,{updateViaCache:"none",scope:"/student_absence/"}).then((function(e){console.log("Registration succeeded. Scope is "+e.scope)})).catch((function(e){console.log("Registration failed with "+e)})),new(a())({el:"#vue-app",data:{menuInfo:{}},store:k,router:Ee,template:'<div><app-menu :menu-info="menuInfo"></app-menu><router-view></router-view></div>',methods:{checkOnlineStatus:function(){var e=this;g().get("/core/ping/",{timeout:5e3}).then((function(){e.$store.commit("changeOnLineStatus",!0),setTimeout((function(){e.checkOnlineStatus()}),5e3)})).catch((function(){e.$store.commit("changeOnLineStatus",!1),setTimeout((function(){e.checkOnlineStatus()}),2e3)}))}},components:{"app-menu":Ne.Z},mounted:function(){var e=this;this.menuInfo=menu,setTimeout((function(){e.checkOnlineStatus()}),3e3),g().get("/student_absence/api/period/").then((function(t){e.$store.commit("setPeriods",t.data.results)}))}})},"./node_modules/deepmerge/dist/cjs.js":e=>{function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(e){return function(e){return!!e&&"object"===t(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===s}(e)}(e)},s="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function a(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function i(e,t){try{return t in e}catch(e){return!1}}function c(e,t,s){(s=s||{}).arrayMerge=s.arrayMerge||a,s.isMergeableObject=s.isMergeableObject||n,s.cloneUnlessOtherwiseSpecified=r;var u=Array.isArray(t);return u===Array.isArray(e)?u?s.arrayMerge(e,t,s):function(e,t,n){var s={};return n.isMergeableObject(e)&&o(e).forEach((function(t){s[t]=r(e[t],n)})),o(t).forEach((function(a){(function(e,t){return i(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,a)||(i(e,a)&&n.isMergeableObject(t[a])?s[a]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(a,n)(e[a],t[a],n):s[a]=r(t[a],n))})),s}(e,t,s):r(t,s)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var u=c;e.exports=u},"./node_modules/vuex-persist/node_modules/flatted/cjs/index.js":(e,t)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=JSON.parse,r=JSON.stringify,a=Object.keys,o=String,i="string",c={},u="object",l=function(e,t){return t},d=function(e){return e instanceof o?o(e):e},f=function(e,t){return n(t)===i?new o(t):t},b=function e(t,s,r,i){for(var l=[],d=a(r),f=d.length,b=0;b<f;b++){var p=d[b],h=r[p];if(h instanceof o){var v=t[h];n(v)!==u||s.has(v)?r[p]=i.call(r,p,v):(s.add(v),r[p]=c,l.push({k:p,a:[t,s,v,i]}))}else r[p]!==c&&(r[p]=i.call(r,p,h))}for(var m=l.length,g=0;g<m;g++){var _=l[g],y=_.k,A=_.a;r[y]=i.call(r,y,e.apply(null,A))}return r},p=function(e,t,n){var s=o(t.push(n)-1);return e.set(n,s),s};t.parse=function(e,t){var r=s(e,f).map(d),a=r[0],o=t||l,i=n(a)===u&&a?b(r,new Set,a,o):a;return o.call({"":i},"",i)},t.stringify=function(e,t,s){for(var a=t&&n(t)===u?function(e,n){return""===e||-1<t.indexOf(e)?n:void 0}:t||l,o=new Map,c=[],d=[],f=+p(o,c,a.call({"":e},"",e)),b=!f;f<c.length;)b=!0,d[f]=r(c[f++],h,s);return"["+d.join(",")+"]";function h(e,t){if(b)return b=!b,t;var s=a.call(this,e,t);switch(n(s)){case u:if(null===s)return s;case i:return o.get(s)||p(o,c,s)}return s}}}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=t,e=[],s.O=(t,n,r,a)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,r,a]=e[u],i=!0,c=0;c<n.length;c++)(!1&a||o>=a)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(i=!1,a<o&&(o=a));i&&(e.splice(u--,1),t=r())}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=766,(()=>{var e={766:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[o,i,c]=n,u=0;for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(c)var l=c(s);for(t&&t(n);u<o.length;u++)a=o[u],s.o(e,a)&&e[a]&&e[a][0](),e[o[u]]=0;return s.O(l)},n=self.webpackChunkhappyschool=self.webpackChunkhappyschool||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=s.O(void 0,[351],(()=>s("./assets/js/student_absence.js")));r=s.O(r)})();